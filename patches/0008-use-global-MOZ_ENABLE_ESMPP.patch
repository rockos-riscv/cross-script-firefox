From c2ecd9f829f1aabb2568ff80e91846a0e6b05ba3 Mon Sep 17 00:00:00 2001
From: Sakura286 <Sakura286>
Date: Fri, 22 Aug 2025 06:34:55 +0000
Subject: [PATCH 08/12] use global MOZ_ENABLE_ESMPP

---
 dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp b/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
index 4135a8e6b9..07e3313e03 100644
--- a/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
+++ b/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
@@ -37,7 +37,6 @@
 #  include "mozilla/layers/DMABUFSurfaceImage.h"
 #  include "FFmpegVideoFramePool.h"
 #  include "va/va.h"
-#define ES_MPP 1
 #endif
 
 #if defined(MOZ_AV1) && \
@@ -1060,14 +1059,14 @@ void FFmpegVideoDecoder<LIBAV_VER>::InitHWCodecContext(ContextType aType) {
   }
 
   if (mCodecID == AV_CODEC_ID_H264) {
-#if !defined(ES_MPP)
+#if !defined(MOZ_ENABLE_ESMPP)
     mCodecContext->extra_hw_frames =
         H264::ComputeMaxRefFrames(mInfo.mExtraData);
 #else
     mCodecContext->extra_hw_frames = 16;
 #endif
   } else if (mCodecID == AV_CODEC_ID_HEVC) {
-#if !defined(ES_MPP)
+#if !defined(MOZ_ENABLE_ESMPP)
     mCodecContext->extra_hw_frames =
         H265::ComputeMaxRefFrames(mInfo.mExtraData);
 #else
-- 
2.43.0

