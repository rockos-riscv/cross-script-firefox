From b4ec2c614cd80b9400a8912ac3c6d4c8360797a0 Mon Sep 17 00:00:00 2001
From: CHEN <chenxuan@iscas.ac.cn>
Date: Thu, 16 Oct 2025 09:57:59 +0000
Subject: [PATCH 08/12] use global MOZ_ENABLE_ESMPP

---
 dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp b/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
index 498e1e3e22..40626736f4 100644
--- a/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
+++ b/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp
@@ -45,7 +45,6 @@
 #  include "mozilla/gfx/gfxVars.h"
 #  include "mozilla/layers/DMABUFSurfaceImage.h"
 #  include "va/va.h"
-#define ES_MPP 1
 #endif
 
 #if defined(MOZ_AV1) && \
@@ -1125,14 +1124,14 @@ void FFmpegVideoDecoder<LIBAV_VER>::InitHWCodecContext(ContextType aType) {
   }
 
   if (mCodecID == AV_CODEC_ID_H264) {
-#if !defined(ES_MPP)
+#if !defined(MOZ_ENABLE_ESMPP)
     mCodecContext->extra_hw_frames =
         H264::ComputeMaxRefFrames(mInfo.mExtraData);
 #else
     mCodecContext->extra_hw_frames = 16;
 #endif
   } else if (mCodecID == AV_CODEC_ID_HEVC) {
-#if !defined(ES_MPP)
+#if !defined(MOZ_ENABLE_ESMPP)
     mCodecContext->extra_hw_frames =
         H265::ComputeMaxRefFrames(mInfo.mExtraData);
 #else
-- 
2.48.1

